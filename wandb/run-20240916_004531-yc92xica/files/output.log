/home/mateo/projects/ai/indiofinder/train.py:161: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
Phase 1: Training only final layer
Training:   0%|                                                                                                                                                         | 0/1 [00:00<?, ?it/s]/home/mateo/projects/ai/indiofinder/train.py:29: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [04:36<00:00, 276.22s/it]
Validating:   0%|                                                                                                                                                       | 0/1 [00:00<?, ?it/s]/home/mateo/projects/ai/indiofinder/train.py:54: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [01:09<00:00, 69.22s/it]
Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [04:40<00:00, 280.16s/it]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [01:09<00:00, 69.12s/it]
Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [04:35<00:00, 275.99s/it]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [01:09<00:00, 69.82s/it]
Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [04:35<00:00, 275.74s/it]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [01:10<00:00, 70.60s/it]
Epoch [4/4000]
Train Loss: 0.6912, Train Accuracy: 0.4900
Val Loss: 0.7015, Val Accuracy: 0.5000
Checkpoint saved: last_checkpoint.pth
Checkpoint saved: checkpoints/best_model.pth
Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [04:38<00:00, 278.15s/it]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [01:10<00:00, 70.44s/it]
Epoch [5/4000]
Train Loss: 0.6715, Train Accuracy: 0.6425
Val Loss: 0.7080, Val Accuracy: 0.4300
Checkpoint saved: last_checkpoint.pth
Training:   0%|                                                                                                                                                         | 0/1 [00:04<?, ?it/s]
Traceback (most recent call last):
  File "/home/mateo/projects/ai/indiofinder/train.py", line 245, in <module>
  File "/home/mateo/projects/ai/indiofinder/train.py", line 219, in main
  File "/home/mateo/projects/ai/indiofinder/train.py", line 24, in train_model
    for inputs, labels in tqdm(train_loader, desc="Training"):
  File "/home/mateo/projects/ai/indiofinder/env/lib/python3.12/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/home/mateo/projects/ai/indiofinder/env/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/home/mateo/projects/ai/indiofinder/env/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1327, in _next_data
    idx, data = self._get_data()
                ^^^^^^^^^^^^^^^^
  File "/home/mateo/projects/ai/indiofinder/env/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1283, in _get_data
    success, data = self._try_get_data()
                    ^^^^^^^^^^^^^^^^^^^^
  File "/home/mateo/projects/ai/indiofinder/env/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1131, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/queue.py", line 180, in get
    self.not_empty.wait(remaining)
  File "/usr/lib/python3.12/threading.py", line 359, in wait
    gotit = waiter.acquire(True, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
